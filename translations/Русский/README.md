# Real-Time

Real-Time - это Filterscript для SA-MP (San Andreas Multiplayer), который синхронизирует игровое время с реальным временем, обеспечивая более глубокое погружение в игру благодаря автоматическому изменению времени на сервере в соответствии с реальным временем.

## Языки

- Português: [README](../../)
- Deutsch: [README](../Deutsch/README.md)
- English: [README](../English/README.md)
- Español: [README](../Espanol/README.md)
- Français: [README](../Francais/README.md)
- Italiano: [README](../Italiano/README.md)
- Polski: [README](../Polski/README.md)
- Svenska: [README](../Svenska/README.md)
- Türkçe: [README](../Turkce/README.md)

## Оглавление

- [Real-Time](#real-time)
  - [Языки](#языки)
  - [Оглавление](#оглавление)
  - [Установка](#установка)
  - [Техническая работа](#техническая-работа)
    - [Система времени](#система-времени)
  - [Варианты использования](#варианты-использования)
    - [Идеально подходит для:](#идеально-подходит-для)
  - [Технические детали](#технические-детали)
    - [Реализованные оптимизации](#реализованные-оптимизации)
    - [Основные функции:](#основные-функции)
  - [Лицензия](#лицензия)
    - [Условия:](#условия)

## Установка

1. Скачайте файл [Real-Time.amx](https://github.com/ocalasans/Real-Time/raw/refs/heads/main/src/Real-Time.amx)
2. Скопируйте файл в папку `filterscripts` вашего сервера
3. Отредактируйте файл `server.cfg`
4. Добавьте `Real-Time` в строку `filterscripts`

**Пример конфигурации в server.cfg:**
```
filterscripts Real-Time
```

> [!WARNING]
> Если другие filterscripts уже загружены, добавьте Real-Time после них.

## Техническая работа

Система работает через оптимизированный таймер, который проверяет текущее время каждые 5 секунд. Ниже приведен фрагмент кода, демонстрирующий, как выполняется проверка:

```pawn
#define TRF_UPDATE_INTERVAL  (5*1000) // Обновление каждые 5 секунд
#define TRF_DAWN_TIME        (5) // 00:00 - 05:59 -> 05:00
#define TRF_MORNING_TIME     (7) // 06:00 - 10:59 -> 07:00
#define TRF_NOON_TIME        (12) // 11:00 - 15:59 -> 12:00
#define TRF_EVENING_TIME     (20) // 16:00 - 17:59 -> 20:00
#define TRF_NIGHT_TIME       (0) // 18:00 - 23:59 -> 00:00
```

### Система времени

Filterscript использует следующие преобразования времени:
- **Рассвет**: 00:00 - 05:59 → 05:00 в игре
- **Утро**: 06:00 - 10:59 → 07:00 в игре
- **День**: 11:00 - 15:59 → 12:00 в игре
- **Вечер**: 16:00 - 17:59 → 20:00 в игре
- **Ночь**: 18:00 - 23:59 → 00:00 в игре

> [!NOTE]
> Система использует `gettime()` для получения текущего времени сервера. Крайне важно, чтобы ваш сервер был настроен с правильным часовым поясом.

## Варианты использования

### Идеально подходит для:

1. **RolePlay серверов**
   - Повышает реалистичность
   - Синхронизирует события сервера с реальным временем
   - Улучшает погружение игроков

2. **DayZ серверов**
   - Реалистичная система дня/ночи
   - Естественный цикл времени
   - Планирование событий на основе реального времени

3. **Соревновательных серверов**
   - Организация событий в определенное время
   - Запланированные изменения окружения
   - Интеграция с системами погоды

## Технические детали

### Реализованные оптимизации

```pawn
// Глобальная переменная для избежания ненужных обновлений
static TRF_Last_WorldTime = -1;

// Оптимизированная функция обновления
public TRF_UpdateWorldTime() {
    new TRF_Current_Hour,
        TRF_Current_Minute,
        TRF_Current_Second;
    
    gettime(TRF_Current_Hour, TRF_Current_Minute, TRF_Current_Second);
    
    // Обновляется только если время изменилось
    if(TRF_New_WorldTime != TRF_Last_WorldTime)
    {
        SetWorldTime(TRF_New_WorldTime);
        TRF_Last_WorldTime = TRF_New_WorldTime;
    }
}
```

### Основные функции:

- Кэширование последнего времени для избежания избыточных обновлений
- Оптимизированный таймер для снижения использования ресурсов
- Полная совместимость с другими filterscripts

> [!IMPORTANT]
> Система была разработана с учетом производительности, выполняя проверки только при необходимости и поддерживая кэш последнего установленного времени.

## Лицензия

Этот Filterscript защищен лицензией Apache License 2.0, которая разрешает:

- ✔️ Коммерческое и частное использование
- ✔️ Модификацию исходного кода
- ✔️ Распространение кода
- ✔️ Патентное использование

### Условия:

- Сохранение уведомления об авторских правах
- Документирование существенных изменений
- Включение копии лицензии Apache License 2.0

Для получения более подробной информации о лицензии: http://www.apache.org/licenses/LICENSE-2.0

**Copyright (c) Calasans - Все права защищены**